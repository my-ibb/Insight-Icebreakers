<?php

namespace Tests\Unit;

use PHPUnit\Framework\TestCase;

class RegexTest extends TestCase
{
    public function testRegexExtraction()
    {
        $content = "[問題文]：\n問題文： ある晴れた日、村の中に立派な看板のついた新しいアンティークショップがオープンしました。このアンティークショップには、貴重な家具や食器、時計などがたくさん展示されています。ある日、村の人々がアンティークショップを訪れました。店主は、とても親切で品物の説明を詳しくしてくれます。村の人たちは、美しい品々を眺めながら楽しい時間を過ごしていました。 しかし、ある女性が特に興味を引かれる品物を見つけました。それは、壷型の陶器の置物で、とても美しい絵付けがされていました。女性は、興味津々で店主に尋ねました。「この壷の絵付けは、有名な陶芸家の作品ですか？」と。店主は微笑みながら答えました。\n\n[答え]：\n答え： この壷は、実は女性自身が10年前に作った作品でした。彼女は若い頃に陶芸を学び、その時にこの壷を制作しました。しかし、忙しい日々に追われていたため、出来上がった作品を見る時間がなく、置きっぱなしになっていたのです。それから10年が経ち、女性は思いがけず自分の作品をアンティークショップで再会することになったのです。彼女は感動の涙を流しながら、思い出と共に壷を取り上げました。";

        preg_match('/\[問題文\]：\n(.*?)\n\n\[答え\]：\n(.*)/us', $content, $matches);

        $extracted_question_content = $matches[1] ?? '';
        $extracted_answer_content = $matches[2] ?? '';

        $expected_question_content = "問題文： ある晴れた日、村の中に立派な看板のついた新しいアンティークショップがオープンしました。このアンティークショップには、貴重な家具や食器、時計などがたくさん展示されています。ある日、村の人々がアンティークショップを訪れました。店主は、とても親切で品物の説明を詳しくしてくれます。村の人たちは、美しい品々を眺めながら楽しい時間を過ごしていました。 しかし、ある女性が特に興味を引かれる品物を見つけました。それは、壷型の陶器の置物で、とても美しい絵付けがされていました。女性は、興味津々で店主に尋ねました。「この壷の絵付けは、有名な陶芸家の作品ですか？」と。店主は微笑みながら答えました。";
        $expected_answer_content = "答え： この壷は、実は女性自身が10年前に作った作品でした。彼女は若い頃に陶芸を学び、その時にこの壷を制作しました。しかし、忙しい日々に追われていたため、出来上がった作品を見る時間がなく、置きっぱなしになっていたのです。それから10年が経ち、女性は思いがけず自分の作品をアンティークショップで再会することになったのです。彼女は感動の涙を流しながら、思い出と共に壷を取り上げました。";

        $this->assertEquals($expected_question_content, $extracted_question_content);
        $this->assertEquals($expected_answer_content, $extracted_answer_content);
    }
}
